<!-- Header -->
<header class="bg-purple-900 shadow-sm border-b border-purple-700 px-4 py-3 fixed top-0 right-0 z-30" 
         [class.left-16]="!sidebarOpen"
         [class.left-64]="sidebarOpen">
  <div class="flex items-center justify-between h-12">
    <!-- Page Title Section -->
    <div class="flex items-center space-x-3">
      <button 
        (click)="onToggleSidebar()"
        class="p-2 rounded-lg hover:bg-purple-800 transition-colors duration-200 flex items-center justify-center">
        <span class="material-icons text-purple-200 text-xl">menu</span>
      </button>
      <div class="flex items-center">
        <h5 class="text-xl font-semibold text-purple-100 leading-tight">{{ pageTitle }}</h5>
      </div>
    </div>

    <!-- Search and Actions Section -->
    <div class="flex items-center space-x-3">
      <!-- Search Bar -->
      <div class="relative">
        <input 
          type="text" 
          placeholder="Search..." 
          class="pl-9 pr-4 py-2.5 text-sm border border-purple-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-transparent w-72 bg-purple-800 focus:bg-purple-700 transition-colors duration-200 text-purple-100 placeholder-purple-300">
        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 material-icons text-purple-300 text-lg">search</span>
      </div>

      <!-- Action Icons -->
      <div class="flex items-center space-x-1">
        <!-- Grid View Button -->
        <!-- <button 
          class="p-2.5 rounded-lg hover:bg-gray-100 transition-colors duration-200 flex items-center justify-center"
          matTooltip="Grid View">
          <span class="material-icons text-gray-600 text-lg">grid_view</span>
        </button> -->
        
        <!-- Notifications Button -->
        <!-- <button 
          class="p-2.5 rounded-lg hover:bg-gray-100 transition-colors duration-200 relative flex items-center justify-center"
          matTooltip="Notifications">
          <span class="material-icons text-gray-600 text-lg">notifications</span>
          <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium">5</span>
        </button> -->
        
        <!-- User Menu -->
        <div class="relative user-menu-container">
          <button 
            (click)="onAccountClick()"
            class="p-2.5 rounded-lg hover:bg-purple-800 transition-colors duration-200 flex items-center space-x-2">
            <!-- User Avatar -->
            <div class="w-8 h-8 bg-gradient-to-r bg-[#ffcd00] text-white rounded-full flex items-center justify-center text-sm font-semibold shadow-sm">
              {{ getUserInitials() }}
            </div>
            <span class="material-icons text-purple-200 text-lg">keyboard_arrow_down</span>
          </button>

          <!-- Dropdown Menu -->
          <div 
            *ngIf="showUserMenu"
            class="absolute right-0 mt-2 w-72 bg-white rounded-xl shadow-xl border border-gray-200 py-2 z-50">
            <!-- User Info -->
            <div class="px-4 py-3 border-b border-gray-100">
              <p class="text-sm font-semibold text-gray-900">{{ getUserDisplayName() }}</p>
              <p class="text-sm text-gray-500 mt-0.5">{{ currentUser?.email }}</p>
              <p class="text-xs text-gray-400 mt-1 bg-gray-100 px-2 py-1 rounded-full inline-block">{{ currentUser?.role }}</p>
            </div>

            <!-- Menu Items -->
            <div class="py-1">
              <button 
                (click)="onProfileClick()"
                class="w-full px-4 py-2.5 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-3 transition-colors duration-200">
                <span class="material-icons text-gray-400 text-lg">person</span>
                <span>Profile</span>
              </button>
              <!-- <button 
                (click)="onSettingsClick()"
                class="w-full px-4 py-2.5 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-3 transition-colors duration-200">
                <span class="material-icons text-gray-400 text-lg">settings</span>
                <span>Settings</span>
              </button> -->
            </div>

            <!-- Logout -->
            <div class="border-t border-gray-100 py-1">
              <button 
                (click)="onLogout()"
                class="w-full px-4 py-2.5 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-3 transition-colors duration-200">
                <span class="material-icons text-red-400 text-lg">logout</span>
                <span>Logout</span>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Settings Button -->
        <button 
          (click)="onThemeSettingsClick()"
          class="p-2.5 rounded-lg hover:bg-purple-800 transition-colors duration-200 flex items-center justify-center"
          matTooltip="Theme Settings">
          <span class="material-icons text-purple-200 text-lg">settings</span>
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Theme Settings Modal -->
<div 
  *ngIf="showThemeModal" 
  class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 theme-modal-container"
  (click)="closeThemeModal()">
  <div 
    class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"
    (click)="$event.stopPropagation()">
    
    <!-- Modal Header -->
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold text-gray-900">Theme Settings</h3>
      <button 
        (click)="closeThemeModal()"
        class="text-gray-400 hover:text-gray-600">
        <span class="material-icons">close</span>
      </button>
    </div>

    <!-- Modal Body -->
    <div class="space-y-6">
      <!-- Theme Selection -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-3">
          Choose Theme
        </label>
        <div class="space-y-3">
          <!-- Normal Theme -->
          <div class="flex items-center space-x-3">
            <input
              type="radio"
              id="light-theme"
              name="theme"
              value="light"
              [(ngModel)]="selectedTheme"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
            <label for="light-theme" class="flex items-center space-x-3 cursor-pointer">
              <div class="w-8 h-8 bg-white border-2 border-gray-300 rounded-lg flex items-center justify-center">
                <span class="material-icons text-gray-600 text-sm">light_mode</span>
              </div>
              <div>
                <div class="text-sm font-medium text-gray-900">Normal</div>
                <div class="text-xs text-gray-500">Clean and bright interface</div>
              </div>
            </label>
          </div>

          <!-- Dark Theme -->
          <div class="flex items-center space-x-3">
            <input
              type="radio"
              id="dark-theme"
              name="theme"
              value="dark"
              [(ngModel)]="selectedTheme"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300">
            <label for="dark-theme" class="flex items-center space-x-3 cursor-pointer">
              <div class="w-8 h-8 bg-gray-800 border-2 border-gray-600 rounded-lg flex items-center justify-center">
                <span class="material-icons text-gray-300 text-sm">dark_mode</span>
              </div>
              <div>
                <div class="text-sm font-medium text-gray-900">Dark Mode</div>
                <div class="text-xs text-gray-500">Easy on the eyes</div>
              </div>
            </label>
          </div>
        </div>
      </div>

    </div>

    <!-- Modal Footer -->
    <div class="flex justify-end space-x-3 mt-6">
      <button
        type="button"
        (click)="closeThemeModal()"
        class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200">
        Cancel
      </button>
      <button
        type="button"
        (click)="applyThemeSettings()"
        class="px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors duration-200"
        style="background-color: var(--button-primary-bg);"
        onmouseover="this.style.backgroundColor='var(--button-primary-hover)'"
        onmouseout="this.style.backgroundColor='var(--button-primary-bg)'"
        onfocus="this.style.backgroundColor='var(--button-primary-focus)'"
        onblur="this.style.backgroundColor='var(--button-primary-bg)'">
        Apply Changes
      </button>
    </div>
  </div>
</div>
